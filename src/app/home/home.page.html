<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title class="ml-3">Viaja Con Aldia</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!-- <ion-fab class="move-fab" vertical="top" horizontal="end">
    <ion-fab-button>
      <ion-icon name="refresh-circle"></ion-icon>
    </ion-fab-button>
  </ion-fab> -->

  <div class="container panel-user-home">
    <div class="row p-3">
      <div class="containerPhoto col col-12 p-2 d-flex justify-content-center">
        <ion-avatar
          [style.width]="'130px'"
          [style.height]="'130px'"
          slot="start"
        >
          <ion-img
            alt="person"
            *ngIf="fotoUser"
            class="rounded-circle me-2"
            [src]="fotoUser"
          ></ion-img>
          <ion-img
            alt="person"
            *ngIf="!fotoUser"
            class="rounded-circle me-2"
            src="../../assets/img/userDefault.png"
          ></ion-img>
        </ion-avatar>
      </div>

      <div class="col col-12 d-flex justify-content-center" style="text-align:center; align-items: center;">
        <ul class="list-unstyled ps-0 ml-3">

          <li class="mb-1">
            <h2 class="text-white">
              <strong id="nameUser"> {{ nombres }} </strong>
            </h2>
          </li>

          <li class="mb-1">
            <h2 class="text-white">
              {{placaLetras}} - {{placaNum}}
            </h2>
          </li>

        </ul>
      </div>
    </div>

  </div>

  <div class="panel-turnos d-flex justify-content-center">


    <div *ngIf="estado">
      <ul class="list-unstyled p-2 ps-0 ml-3">
        <li style="text-align:center;">
          <span class="{{clase_estado}}">
            {{ turnoExistente ? 'Enturnado: ' + origen : 'Sin Turno' }}
          </span>
        </li>
        <p class="tiemporestante mb-0">
          {{ turnoExistente ? 'Reenturnarse en: ' +
          listTurnos.data.tiemporestante : '' }}
        </p>
        <li>
          <span>

          </span>
        </li>
        <li class="mt-3 d-flex justify-content-center">
           <ion-button
              (click)="turnoExistente ? getTurno() : nuevoTurno()"
              id="open-modal"
              class="botontiemporestante"
              expand="full"
              shape="round"
              [color]="turnoExistente ? 'success' : 'danger'">
               <span class="ml-2 mb-0">
                {{ estadoBoton }}
               </span>
           </ion-button>

        </li>
      </ul>
    </div>

    <div *ngIf="!estado && !botonInactivo && !botonDocumentos">
      <span class="ml-2 mb-0">
        {{ estadoBoton }}
       </span>
    </div>


    <div class="mt-3 mb-3 d-flex justify-content-center" *ngIf="botonInactivo">
      <ion-button
      id="open-modal"
      class="botontiemporestante"
      expand="full"
      shape="round"
      color="danger">
       <span class="ml-2 mb-0">
        {{ estadoBoton }}
       </span>
   </ion-button>
    </div>



    <div class="mt-3 mb-3 d-flex justify-content-center" *ngIf="botonDocumentos">
      <ion-button
      id="open-modal"
      class="botontiemporestante"
      expand="full"
      shape="round"
      color="danger">
       <span class="ml-2 mb-0">
        {{ estadoBoton }}
       </span>
   </ion-button>
    </div>

  </div>

  <div *ngIf="turnoExistente" class="container cont-turnos">
    <div class="origen" style="text-align: center;"> <h1> Destinos </h1> </div>
    <div class="container-ticket">

      <div class="ticket">
        <p>{{destino1}}</p>
        <img
        src="../../assets/icon/tiket.png"
        alt="ticket"
        />
        <span>{{posicionTurno1}}</span>
      </div>

      <div class="ticket">
        <p>{{destino2}}</p>
        <img
          src="../../assets/icon/tiket.png"
          alt="ticket"
        />
        <span>{{posicionTurno2}}</span>
      </div>

      <div class="ticket">
        <p>{{destino3}}</p>
        <img
        src="../../assets/icon/tiket.png"
        alt="ticket"
          />
        <span>{{posicionTurno3}}</span>
      </div>

    </div>
  </div>



 <ion-modal
    #modalTurno
    trigger="open-modal"
    [initialBreakpoint]="0.70"
    [breakpoints]="[0.7, 0.8, 0.9]"
    handleBehavior="cycle"
  >
    <ng-template>
      <ion-content class="ion-padding">
        <div class="container-fluid">
          <div class="row d-flex justify-content-center">
            <div class="container panel-turno">
              <div
                class="col-md-12 d-flex mt-4 mb-4 justify-content-center text-center text-white"
              >
                <h3>Reenturnarse</h3>
              </div>
            </div>

            <div class="col-md-8">
              <form [formGroup]="turnoForm" (ngSubmit)="onSubmit()">
                <div class="form-row p-2">
                  <div class="col-md-12 mt-2">
                    <label id="origenLabel" for=""
                      >Origen: <ion-spinner></ion-spinner
                    ></label>
                    <input
                      [ngModel]="nombre"
                      type="hidden"
                      id="origen"
                      formControlName="origen"
                    />
                  </div>
                  <ion-item class="col-md-12 mt-2">
                    <ion-select
                      formControlName="destino1"
                      interface="action-sheet"
                      placeholder="* Selecciona la ciudad de destino 1 ..."
                    >
                      <ion-select-option></ion-select-option>
                      <ion-select-option
                        *ngFor="let p of turno.regionales"
                        value="{{ p.nombre }}"
                        >{{ p.nombre }}</ion-select-option
                      >
                    </ion-select>
                  </ion-item>
                  <ion-item class="col-md-12 mt-2">
                    <ion-select
                      formControlName="destino2"
                      interface="action-sheet"
                      placeholder="* Selecciona la ciudad de destino 2 ..."
                    >
                      <ion-select-option></ion-select-option>
                      <ion-select-option
                        *ngFor="let p of turno.regionales"
                        value="{{ p.nombre }}"
                        >{{ p.nombre }}</ion-select-option
                      >
                    </ion-select>
                  </ion-item>
                  <ion-item class="col-md-12 mt-2">
                    <ion-select
                      formControlName="destino3"
                      interface="action-sheet"
                      placeholder="* Selecciona la ciudad de destino 3 ..."
                    >
                      <ion-select-option></ion-select-option>
                      <ion-select-option
                        *ngFor="let p of turno.regionales"
                        value="{{ p.nombre }}"
                        >{{ p.nombre }}</ion-select-option
                      >
                    </ion-select>
                  </ion-item>

                  <div class="col-md-12 mt-2 mb-3">
                    <label for="remolque">Tipo de Remolque</label>
                    <ion-select
                      interface="action-sheet"
                      formControlName="remolque"
                      id="remolque"
                      required
                    >
                      <ion-select-option selected
                        >Seleccionar</ion-select-option
                      >
                      <ion-select-option value="CONTENEDOR"
                        >CONTENEDOR</ion-select-option
                      >
                      <ion-select-option value="PLANCHA"
                        >PLANCHA</ion-select-option
                      >
                    </ion-select>
                  </div>

                  <h6
                    style="color: #db1824; font-size: 12px"
                    id="labelPorcentaje"
                  >
                    * De detectar que la información brindada no es cierta podrá
                    incurrir en sanciones drásticas por parte de la compañía.
                  </h6>

                  <div class="col-md-12 mt-4 mb-4">
                    <label for="">Vehiculo vacio</label>
                    <ion-select
                      interface="action-sheet"
                      formControlName="vehiculovac"
                      id="vehiculovac"
                      required
                    >
                      <ion-select-option selected
                        >Seleccionar</ion-select-option
                      >
                      <ion-select-option value="SI">SI</ion-select-option>
                      <ion-select-option value="NO">NO</ion-select-option>
                    </ion-select>
                  </div>
                </div>

                <ion-button expand="block" color="primary" type="submit" [disabled]="turnoForm.invalid || isSubmitting">
                  {{ isSubmitting ? 'Enviando...' : 'Enturnarme' }}
                </ion-button>
              </form>
            </div>
          </div>
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>
