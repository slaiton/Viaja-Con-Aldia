"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5563],{5563:(T,h,n)=>{n.r(h),n.d(h,{LoginPageModule:()=>M});var v=n(6895),r=n(433),a=n(603),m=n(3599),u=n(7582),d=n(2263),C=n(5548),p=n(2340);const P=(0,n(7423).fo)("Browser",{web:()=>n.e(6874).then(n.bind(n,6874)).then(e=>new e.BrowserWeb)});var t=n(1571),A=n(9975),y=n(8965),S=n(5657),F=n(997);const L=[{path:"",component:(()=>{class e{constructor(i,o,s,g,c,f,B,k,U){this.app=i,this.menu=o,this.alertController=s,this.formBuilder=g,this.userService=c,this.cookies=f,this.router=B,this.platform=k,this.user=U,this.loginForm=r.cw,this.version=p.N.version,this.initializeApp()}get f(){return this.loginForm.controls}onLogin(){if(this.submitClick)return;this.submitClick=!0;const i={numeroPlacaxxx:this.loginForm.value.password.toUpperCase(),codigoTercerox:this.loginForm.value.username,version:p.N.version};this.userService.login(i).subscribe(o=>{this.presentAlert("Alerta","Bienvenido","App de ChecList","Continuar"),localStorage.setItem("placa",this.loginForm.value.password.toUpperCase()),this.userService.setToken(o.access_token),this.submitClick=!1,localStorage.setItem("conductor",this.loginForm.value.username),this.menu.enable(!0),this.userService.onLoginChange.next(o.token),this.app.ngOnInit(),this.router.navigate(["/home"])},o=>{this.presentAlert("Error","Fallo al ingresar",o.error.data,"Cerrar"),this.submitClick=!1})}ngOnInit(){return(0,u.mG)(this,void 0,void 0,function*(){if(this.submitClick=!1,null!=localStorage.getItem("placa")&&localStorage.getItem("token")){const o={token:this.userService.getToken()};this.userService.tokenValidate(o).subscribe(s=>{this.router.navigate(["/home"])})}this.platform.backButton.subscribeWithPriority(10,()=>{C.g.exitApp()}),this.fechaActual=(new Date).getFullYear(),this.loginForm=this.formBuilder.group({username:["",[r.kI.required]],password:["",[r.kI.required]]}),yield this.validateVersion()})}validateVersion(){return(0,u.mG)(this,void 0,void 0,function*(){yield this.user.getDataApi("","","api/version/latest").then(i=>{if(i.version_number>p.N.version){const s="https://play.google.com/store/apps/details?id=io.ionic.viajaconaldia";this.presentAlertFun("Alerta","","Se requiere actualizacion para continuar","Actualizar").then(()=>{P.open({url:s})})}})})}initializeApp(){this.platform.ready().then(()=>{this.setStatusBarColor()})}setStatusBarColor(){this.platform.is("android")?d.A_.setBackgroundColor({color:"#5C8CDF"}):this.platform.is("ios")&&d.A_.setStyle({style:d.bg.Dark})}presentAlert(i,o,s,g){return(0,u.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:""+i,subHeader:""+o,message:""+s,buttons:[""+g]})).present()})}presentAlertFun(i,o,s,g){return(0,u.mG)(this,void 0,void 0,function*(){return new Promise(c=>(0,u.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:i,subHeader:o,message:s,backdropDismiss:!1,buttons:[{text:g,handler:()=>{c()}}]})).present()}))})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(A.y),t.Y36(a._q),t.Y36(a.Br),t.Y36(r.qu),t.Y36(y.e),t.Y36(S.N),t.Y36(m.F0),t.Y36(a.t4),t.Y36(F.K))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-login"]],decls:21,vars:6,consts:[[3,"translucent"],[1,"container-fluid","p-3"],[1,"sing-in","text-center"],[1,"form-signin","w-100","m-auto","p-2"],[3,"formGroup","ngSubmit"],["src","../../assets/icon/favicon.png","alt","","height","150",1,"mb-4"],[1,"form-floating"],["type","number","formControlName","username","name","username","matInput","","id","username","placeholder","Usuario","required","",1,"form-control"],["for","floatingInput"],["type","password","formControlName","password","name","password","matInput","","id","password","placeholder","Clave","required","",1,"form-control"],["for","floatingPassword"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"registro","mt-2"],["href","/registro",1,"link"],[1,"mt-5","mb-3","text-muted"]],template:function(i,o){1&i&&(t._UZ(0,"ion-header",0),t.TgZ(1,"ion-content",1)(2,"div",2)(3,"main",3)(4,"form",4),t.NdJ("ngSubmit",function(){return o.onLogin()}),t._UZ(5,"img",5),t.TgZ(6,"div",6),t._UZ(7,"input",7),t.TgZ(8,"label",8),t._uU(9,"Cedula"),t.qZA()(),t.TgZ(10,"div",6),t._UZ(11,"input",9),t.TgZ(12,"label",10),t._uU(13,"Placa"),t.qZA()(),t.TgZ(14,"button",11),t._uU(15),t.qZA(),t.TgZ(16,"div",12)(17,"a",13),t._uU(18,"Registrarse"),t.qZA()(),t.TgZ(19,"p",14),t._uU(20),t.qZA()()()()()),2&i&&(t.Q6J("translucent",!0),t.xp6(4),t.Q6J("formGroup",o.loginForm),t.xp6(10),t.Q6J("disabled",o.submitClick),t.xp6(1),t.hij(" ",o.submitClick?"Cargando...":"Iniciar Sesion",""),t.xp6(5),t.AsE("Viaja Con Aldia V.",o.version," \xa9",o.fechaActual,""))},dependencies:[r._Y,r.Fj,r.wV,r.JJ,r.JL,r.Q7,a.W2,a.Gu,r.sg,r.u],styles:["ion-content[_ngcontent-%COMP%]{--background: linear-gradient(#5b8bdf, #f4f5f8)}.form-signin[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form-signin[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:90%}.form-floating[_ngcontent-%COMP%]{margin-bottom:10px}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]{border-radius:25px}.registro[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#5b8bdf}"]}),e})()}];let Z=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.Bz.forChild(L),m.Bz]}),e})(),M=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[v.ez,r.u5,a.Pc,Z,r.UX]}),e})()}}]);